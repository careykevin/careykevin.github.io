{"paragraphs":[{"text":"import org.apache.spark.sql.SQLContext\n\n// Read CSV to RDD\n// TODO: Copy this CSV file locally a change path to local file system\nval path = \"https://careykevin.github.io/Batting.csv\"\nval battingYears = new SQLContext(sc)\n    .read\n    .format(\"com.databricks.spark.csv\")\n    .option(\"header\", \"true\")\n    .option(\"inferSchema\", \"true\")\n    .load(path)\n    .rdd\n\n// Sum HR by playerID, save to table\nbattingYears\n    .map(row => (row.getAs[String](\"playerID\"), Option(row.getAs[Int](\"HR\")).getOrElse(0)))\n    .reduceByKey(_ + _)\n    .toDF(\"playerId\", \"totalHomeRuns\")\n    .registerTempTable(\"players\")\n\n// Sum HR by year, save to table\nbattingYears\n    .map(row => (row.getAs[Int](\"yearID\"), row.getAs[Int](\"HR\")))\n    .reduceByKey(_ + _)\n    .toDF(\"year\", \"totalHomeRuns\")\n    .registerTempTable(\"years\")\n    \n// Sum HR by team, save to table\nbattingYears\n    .map(row => ((row.getAs[String](\"lgID\"), row.getAs[Int](\"yearID\")), row.getAs[Int](\"HR\")))\n    .reduceByKey(_ + _)\n    .map(r => (r._1._1, r._1._2, r._2))\n    .toDF(\"leagueId\", \"year\", \"totalHomeRuns\")\n    .registerTempTable(\"leagues\")    ","dateUpdated":"2016-10-21T16:55:53-0400","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477083144202_-1260115631","id":"20161018-151602_2089786271","result":{"code":"ERROR","type":"TEXT","msg":"\nimport org.apache.spark.sql.SQLContext\n\npath: String = https://careykevin.github.io/Batting.csv\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\njava.io.IOException: No FileSystem for scheme: https\n  at org.apache.hadoop.fs.FileSystem.getFileSystemClass(FileSystem.java:2385)\n  at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2392)\n  at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:89)\n  at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2431)\n  at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2413)\n  at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:368)\n  at org.apache.hadoop.fs.Path.getFileSystem(Path.java:296)\n  at org.apache.spark.sql.execution.datasources.DataSource$$anonfun$12.apply(DataSource.scala:352)\n  at org.apache.spark.sql.execution.datasources.DataSource$$anonfun$12.apply(DataSource.scala:350)\n  at scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:241)\n  at scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:241)\n  at scala.collection.immutable.List.foreach(List.scala:381)\n  at scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:241)\n  at scala.collection.immutable.List.flatMap(List.scala:344)\n  at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:149)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:132)\n  ... 46 elided\n"},"dateCreated":"2016-10-21T16:52:24-0400","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:861","dateFinished":"2016-10-21T16:53:45-0400","dateStarted":"2016-10-21T16:53:45-0400","focus":true},{"title":"Home Runs by Year","text":"%sql select * from years","dateUpdated":"2016-10-21T16:53:45-0400","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"graph":{"mode":"lineChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"totalHomeRuns","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year","index":0,"aggr":"sum"},"yAxis":{"name":"totalHomeRuns","index":1,"aggr":"sum"}},"lineWithFocus":false,"forceY":false},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477083144202_-1260115631","id":"20161018-182541_954854381","result":{"code":"ERROR","type":"TEXT","msg":"Table or view not found: years; line 1 pos 14\nset zeppelin.spark.sql.stacktrace = true to see full stacktrace"},"dateCreated":"2016-10-21T16:52:24-0400","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:862","dateFinished":"2016-10-21T16:53:45-0400","dateStarted":"2016-10-21T16:53:45-0400"},{"title":"Home Runs by Player","text":"%sql select * from players order by totalHomeRuns desc","dateUpdated":"2016-10-21T16:53:45-0400","config":{"tableHide":false,"colWidth":6,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"playerId","index":0,"aggr":"sum"}],"values":[{"name":"totalHomeRuns","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"playerId","index":0,"aggr":"sum"},"yAxis":{"name":"totalHomeRuns","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477083144203_-1260500380","id":"20161018-154218_1988572203","result":{"code":"ERROR","type":"TEXT","msg":"Table or view not found: players; line 1 pos 14\nset zeppelin.spark.sql.stacktrace = true to see full stacktrace"},"dateCreated":"2016-10-21T16:52:24-0400","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:863","dateFinished":"2016-10-21T16:53:45-0400","dateStarted":"2016-10-21T16:53:45-0400"},{"title":"Home Runs by Year and League","text":"%sql select * from leagues order by year, leagueId","dateUpdated":"2016-10-21T16:53:45-0400","config":{"lineNumbers":false,"tableHide":false,"colWidth":6,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"graph":{"mode":"lineChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":1,"aggr":"sum"}],"values":[{"name":"totalHomeRuns","index":2,"aggr":"sum"}],"groups":[{"name":"leagueId","index":0,"aggr":"sum"}],"scatter":{"xAxis":{"name":"leagueId","index":0,"aggr":"sum"},"yAxis":{"name":"year","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477083144205_-1262808874","id":"20161019-083348_648221630","result":{"code":"ERROR","type":"TEXT","msg":"Table or view not found: leagues; line 1 pos 14\nset zeppelin.spark.sql.stacktrace = true to see full stacktrace"},"dateCreated":"2016-10-21T16:52:24-0400","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:864","dateFinished":"2016-10-21T16:53:45-0400","dateStarted":"2016-10-21T16:53:45-0400"},{"text":"","dateUpdated":"2016-10-21T16:53:45-0400","config":{"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477083144207_-1262039376","id":"20161019-090543_596346629","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-10-21T16:52:24-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:865","dateFinished":"2016-10-21T16:53:45-0400","dateStarted":"2016-10-21T16:53:45-0400"}],"name":"MLBHomeRuns","id":"2BZPJX329","angularObjects":{"2C1V8ARHA:shared_process":[],"2BY498VX9:shared_process":[],"2C15QSR2E:shared_process":[],"2C1R3MBNS:shared_process":[],"2C1UC7KQ9:shared_process":[],"2BYGEXSKZ:shared_process":[],"2C1VQRWF1:shared_process":[],"2BYPTQAZW:shared_process":[],"2BZPSUUYC:shared_process":[],"2BZAQFMAJ:shared_process":[],"2BXWCZ1GV:shared_process":[],"2BZZ5AGZ4:shared_process":[],"2C173FZDH:shared_process":[],"2C1TUNHEC:shared_process":[],"2BYZAQ4EG:shared_process":[],"2BYGAEA8Q:shared_process":[],"2C2746UAY:shared_process":[],"2C1XKJ6ZE:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}